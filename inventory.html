<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inventario - Govinda's</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <header>
    <h1>Inventario</h1>
    <nav>
      <a href="index.html" class="menu-link">Volver al Menú</a>
      <a href="orders.html" class="menu-link">Pedidos</a>
    </nav>
  </header>

  <main>
    <section>
      <h2>Productos</h2>
      <div class="inventory-summary">
        <h3>Resumen de Inventario</h3>
        <p>Total de productos: <span id="product-count">0</span></p>
        <p>Total de materias primas: <span id="raw-material-count">0</span></p>
      </div>
      <ul class="inventory-list" id="product-list"></ul>

      <h2>Materias Primas</h2>
      <ul class="raw-material-list" id="raw-material-list"></ul>

      <h2>Agregar Producto/Materia Prima</h2>
      <form class="inventory-form" id="add-item-form">
        <input type="text" id="item-name" placeholder="Nombre del producto" required>
        <input type="number" id="item-price" placeholder="Precio unitario" required>
        <input type="number" id="item-quantity" placeholder="Cantidad" required>
        <select id="item-type" required>
          <option value="product">Producto</option>
          <option value="rawMaterial">Materia Prima</option>
        </select>
        <input type="file" id="item-image">
        <button type="submit">Agregar al Inventario</button>
      </form>
    </section>
  </main>

  <script>
    // Cargar inventario desde localStorage, si no hay, inicializa vacío
    let inventory = JSON.parse(localStorage.getItem('inventory')) || { products: [], rawMaterials: [] };

    // Función para renderizar los productos en el inventario
    function renderInventory() {
      const productList = document.getElementById('product-list');
      const rawMaterialList = document.getElementById('raw-material-list');
      const productCount = document.getElementById('product-count');
      const rawMaterialCount = document.getElementById('raw-material-count');

      // Limpiar las listas antes de renderizar
      productList.innerHTML = '';
      rawMaterialList.innerHTML = '';

      // Renderizar productos
      inventory.products.forEach(item => {
        const li = document.createElement('li');
        li.innerHTML = `<p><strong>${item.name}</strong></p>
                        <p>Precio: $${item.price}</p>
                        <p>Cantidad: ${item.quantity}</p>`;
        productList.appendChild(li);
      });

      // Renderizar materias primas
      inventory.rawMaterials.forEach(item => {
        const li = document.createElement('li');
        li.innerHTML = `<p><strong>${item.name}</strong></p>
                        <p>Precio: $${item.price}</p>
                        <p>Cantidad: ${item.quantity}</p>`;
        rawMaterialList.appendChild(li);
      });

      // Actualizar los contadores de productos y materias primas
      productCount.textContent = inventory.products.length;
      rawMaterialCount.textContent = inventory.rawMaterials.length;
    }

    // Manejar el formulario de agregar producto o materia prima
    document.getElementById('add-item-form').addEventListener('submit', function(event) {
      event.preventDefault();
      const name = document.getElementById('item-name').value;
      const price = parseFloat(document.getElementById('item-price').value);
      const quantity = parseInt(document.getElementById('item-quantity').value);
      const type = document.getElementById('item-type').value;
      const image = document.getElementById('item-image').files[0];

      // Validación de datos
      if (!name || isNaN(price) || isNaN(quantity) || quantity <= 0) {
        alert("Por favor, ingresa todos los campos correctamente.");
        return;
      }

      // Crear nuevo producto o materia prima
      const newItem = {
        name,
        price,
        quantity,
        image: image ? URL.createObjectURL(image) : null
      };

      // Agregar al tipo correspondiente (producto o materia prima)
      if (type === 'product') {
        inventory.products.push(newItem);
      } else {
        inventory.rawMaterials.push(newItem);
      }

      // Guardar el inventario en localStorage
      localStorage.setItem('inventory', JSON.stringify(inventory));

      // Actualizar la vista del inventario
      renderInventory();

      // Limpiar el formulario
      document.getElementById('add-item-form').reset();
    });

    // Cargar inventario al cargar la página
    renderInventory();
  </script>
</body>
</html>
